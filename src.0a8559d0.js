parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Iz2K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class t{constructor(t){this.baseUrl_=t,this.pages_=[""],this.currentPage_=0}nextPage(){return this.currentPage_!==this.pages_.length-1&&(this.currentPage_++,!0)}prevPage(){return 0!==this.currentPage_&&(this.currentPage_--,!0)}getUrl_(){const t=this.pages_[this.currentPage_];return`${this.baseUrl_}?after=${t}`}async fetch(){const t=await fetch(this.getUrl_()),e=await t.json();return this.currentPage_===this.pages_.length-1&&this.pages_.push(e.data.after),e.data.children.map(({data:t},e)=>{const r={url:t.url,author:t.author,title:t.title,permalink:"https://reddit.com"+t.permalink,id:t.id,index:e+1};return t.is_video&&t.media.reddit_video?Object.assign(r,this.extractVideo_(t)):t.url.startsWith("https://v.redd.it/")?Object.assign(r,this.guessVideo_(t)):t.url.startsWith("https://i.redd.it/")?Object.assign(r,this.extractImage_(t)):t.url.startsWith("https://gfycat.com/")&&Object.assign(r,this.extractGfycat_(t)),r}).filter(t=>t.image||t.video||t.gfycat)}extractImage_(t){return{image:{width:t.thumbnail_width,height:t.thumbnail_height,src:t.url}}}extractGfycat_(t){const e=t.url.match(/^https:\/\/gfycat\.com\/([^\/]+)/);return e?{gfycat:{width:t.thumbnail_width,height:t.thumbnail_height,id:e[1]}}:{}}extractVideo_(t){return{video:{poster:this.getPoster_(t),src:{fallback:t.media.reddit_video.fallback_url,hls:t.media.reddit_video.hls_url,dash:t.media.reddit_video.dash_url}}}}guessVideo_(t){return{video:{poster:this.getPoster_(t),src:{fallback:`${t.url}/DASH_480?source=fallback`,hls:`${t.url}/HLSPlaylist.m3u8`,dash:`${t.url}/DASHPlaylist.mpd`}}}}getPoster_(t){if(t.preview&&t.preview.images)return t.preview.images[0].source.url.replace(/&amp;/g,"&")}}exports.default=t;
},{}],"P52C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultTarget=exports.targets=void 0;const t={"#me":{url:"https://www.reddit.com/r/me_irl.json",title:"me_irl"},"#new":{url:"https://www.reddit.com/r/me_irl/new.json",title:"me_irl"},"#meow":{url:"https://www.reddit.com/r/MEOW_IRL.json",title:"meow_irl"},"#woof":{url:"https://www.reddit.com/r/woof_irl.json",title:"woof_irl"}};exports.targets=t;const e="#meow";exports.defaultTarget="#meow";
},{}],"pLyG":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,n){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?n(exports):"function"==typeof t&&t.amd?t(["exports"],n):(e.Mustache={},n(e.Mustache))}(this,function(t){var e=Object.prototype.toString,n=Array.isArray||function(t){return"[object Array]"===e.call(t)};function r(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(t,e){return null!=t&&"object"==typeof t&&e in t}var s=RegExp.prototype.test;var a=/\S/;function u(t){return!function(t,e){return s.call(t,e)}(a,t)}var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var c=/\s*/,l=/\s+/,h=/\s*=/,f=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/;function v(t){this.string=t,this.tail=t,this.pos=0}function d(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function y(){this.cache={}}v.prototype.eos=function(){return""===this.tail},v.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},v.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},d.prototype.push=function(t){return new d(t,this)},d.prototype.lookup=function(t){var e,n,i,s=this.cache;if(s.hasOwnProperty(t))e=s[t];else{for(var a,u,p,c=this,l=!1;c;){if(t.indexOf(".")>0)for(a=c.view,u=t.split("."),p=0;null!=a&&p<u.length;)p===u.length-1&&(l=o(a,u[p])||(n=a,i=u[p],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(i))),a=a[u[p++]];else a=c.view[t],l=o(c.view,t);if(l){e=a;break}c=c.parent}s[t]=e}return r(e)&&(e=e.call(this.view)),e},y.prototype.clearCache=function(){this.cache={}},y.prototype.parse=function(e,r){var o=this.cache,s=e+":"+(r||t.tags).join(":"),a=o[s];return null==a&&(a=o[s]=function(e,r){if(!e)return[];var o,s,a,p=!1,d=[],y=[],w=[],x=!1,b=!1,k="",m=0;function E(){if(x&&!b)for(;w.length;)delete y[w.pop()];else w=[];x=!1,b=!1}function U(t){if("string"==typeof t&&(t=t.split(l,2)),!n(t)||2!==t.length)throw new Error("Invalid tags: "+t);o=new RegExp(i(t[0])+"\\s*"),s=new RegExp("\\s*"+i(t[1])),a=new RegExp("\\s*"+i("}"+t[1]))}U(r||t.tags);for(var j,T,P,S,V,C,O=new v(e);!O.eos();){if(j=O.pos,P=O.scanUntil(o))for(var A=0,I=P.length;A<I;++A)u(S=P.charAt(A))?(w.push(y.length),k+=S):(b=!0,p=!0,k+=" "),y.push(["text",S,j,j+1]),j+=1,"\n"===S&&(E(),k="",m=0,p=!1);if(!O.scan(o))break;if(x=!0,T=O.scan(g)||"name",O.scan(c),"="===T?(P=O.scanUntil(h),O.scan(h),O.scanUntil(s)):"{"===T?(P=O.scanUntil(a),O.scan(f),O.scanUntil(s),T="&"):P=O.scanUntil(s),!O.scan(s))throw new Error("Unclosed tag at "+O.pos);if(V=">"==T?[T,P,j,O.pos,k,m,p]:[T,P,j,O.pos],m++,y.push(V),"#"===T||"^"===T)d.push(V);else if("/"===T){if(!(C=d.pop()))throw new Error('Unopened section "'+P+'" at '+j);if(C[1]!==P)throw new Error('Unclosed section "'+C[1]+'" at '+j)}else"name"===T||"{"===T||"&"===T?b=!0:"="===T&&U(P)}if(E(),C=d.pop())throw new Error('Unclosed section "'+C[1]+'" at '+O.pos);return function(t){for(var e,n=[],r=n,i=[],o=0,s=t.length;o<s;++o)switch((e=t[o])[0]){case"#":case"^":r.push(e),i.push(e),r=e[4]=[];break;case"/":i.pop()[5]=e[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(e)}return n}(function(t){for(var e,n,r=[],i=0,o=t.length;i<o;++i)(e=t[i])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}(y))}(e,r)),a},y.prototype.render=function(t,e,n,r){var i=this.parse(t,r),o=e instanceof d?e:new d(e);return this.renderTokens(i,o,n,t,r)},y.prototype.renderTokens=function(t,e,n,r,i){for(var o,s,a,u="",p=0,c=t.length;p<c;++p)a=void 0,"#"===(s=(o=t[p])[0])?a=this.renderSection(o,e,n,r):"^"===s?a=this.renderInverted(o,e,n,r):">"===s?a=this.renderPartial(o,e,n,i):"&"===s?a=this.unescapedValue(o,e):"name"===s?a=this.escapedValue(o,e):"text"===s&&(a=this.rawValue(o)),void 0!==a&&(u+=a);return u},y.prototype.renderSection=function(t,e,i,o){var s=this,a="",u=e.lookup(t[1]);if(u){if(n(u))for(var p=0,c=u.length;p<c;++p)a+=this.renderTokens(t[4],e.push(u[p]),i,o);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)a+=this.renderTokens(t[4],e.push(u),i,o);else if(r(u)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(u=u.call(e.view,o.slice(t[3],t[5]),function(t){return s.render(t,e,i)}))&&(a+=u)}else a+=this.renderTokens(t[4],e,i,o);return a}},y.prototype.renderInverted=function(t,e,r,i){var o=e.lookup(t[1]);if(!o||n(o)&&0===o.length)return this.renderTokens(t[4],e,r,i)},y.prototype.indentPartial=function(t,e,n){for(var r=e.replace(/[^ \t]/g,""),i=t.split("\n"),o=0;o<i.length;o++)i[o].length&&(o>0||!n)&&(i[o]=r+i[o]);return i.join("\n")},y.prototype.renderPartial=function(t,e,n,i){if(n){var o=r(n)?n(t[1]):n[t[1]];if(null!=o){var s=t[6],a=t[5],u=t[4],p=o;return 0==a&&u&&(p=this.indentPartial(o,u,s)),this.renderTokens(this.parse(p,i),e,n,p)}}},y.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},y.prototype.escapedValue=function(e,n){var r=n.lookup(e[1]);if(null!=r)return t.escape(r)},y.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="3.1.0",t.tags=["{{","}}"];var w=new y;return t.clearCache=function(){return w.clearCache()},t.parse=function(t,e){return w.parse(t,e)},t.render=function(t,e,r,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(o=t)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return w.render(t,e,r,i)},t.to_html=function(e,n,i,o){var s=t.render(e,n,i);if(!r(o))return s;o(s)},t.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return p[t]})},t.Scanner=v,t.Context=d,t.Writer=y,t});
},{}],"sC8V":[function(require,module,exports) {

},{}],"ADAM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("./RedditService")),e=require("./targets"),i=a(require("mustache")),n=a(require("fs"));function a(t){return t&&t.__esModule?t:{default:t}}const s='<!doctype html>\n\x3c!--\n Copyright 2019 Google LLC\n\n Licensed under the Apache License, Version 2.0 (the "License");\n you may not use this file except in compliance with the License.\n You may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\n Unless required by applicable law or agreed to in writing, software\n distributed under the License is distributed on an "AS IS" BASIS,\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n--\x3e\n\n<html âš¡ lang="en">\n\n<head>\n  <meta charset="utf-8">\n  <script async src="https://cdn.ampproject.org/v0.js"><\/script>\n  <script async custom-element="amp-story" src="https://cdn.ampproject.org/v0/amp-story-1.0.js"><\/script>\n  <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"><\/script>\n  <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-gfycat-0.1.js"><\/script>\n  <title>{{title}}</title>\n  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">\n  <link rel="canonical" href="{{canonical}}">\n  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>\n  <style amp-custom>\n    amp-img img {\n      object-fit: contain;\n    }\n  </style>\n</head>\n\n<body>\n  <amp-story standalone title="{{title}}">\n    {{#items}}\n    <amp-story-page id="page{{index}}" data-reddit-id="{{id}}">\n      <amp-story-grid-layer template="vertical">\n        {{#video}}\n        <amp-video autoplay poster="{{poster}}" layout="fill">\n          <source src={{src.dash}} type="application/dash+xml">\n          <source src={{src.hls}} type="application/vnd.apple.mpegURL">\n          <source src="{{src.fallback}}" type="video/mp4">\n        </amp-video>\n        {{/video}}\n        {{#image}}\n        <amp-img src="{{src}}" layout="fill">\n        </amp-img>\n        {{/image}}\n        {{#gfycat}}\n        <amp-gfycat data-gfyid="{{id}}" layout="responsive" width="1" height="2">\n        </amp-gfycat>\n        {{/gfycat}}\n      </amp-story-grid-layer>\n    </amp-story-page>\n    {{/items}}\n  </amp-story>\n</body>\n\n</html>\n';i.default.parse(s);class r{constructor({container:t,iframe:e,next:i,prev:n,link:a}){this.container_=t,this.iframe_=null,this.link_=a,this.update_=this.update_.bind(this),this.onNextClick_=this.onNextClick_.bind(this),this.onPrevClick_=this.onPrevClick_.bind(this),this.onStoryPageChange_=this.onStoryPageChange_.bind(this),window.addEventListener("hashchange",this.update_),i.addEventListener("click",this.onNextClick_),n.addEventListener("click",this.onPrevClick_),this.update_()}onNextClick_(t){t.preventDefault(),this.irl.nextPage()&&this.render_()}onPrevClick_(t){t.preventDefault(),this.irl.prevPage()&&this.render_()}onStoryPageChange_(t){const e=t.getAttribute("data-reddit-id"),{title:i,permalink:n}=this.itemMap_.get(e);this.link_.textContent=`ðŸ”— ${i}`,this.link_.setAttribute("href",n)}async update_(){e.targets[window.location.hash]||(window.location.hash=e.defaultTarget),this.target_=e.targets[window.location.hash],this.container_.className="",await this.display_(),this.container_.className="loaded"}async display_(){this.irl=new t.default(this.target_.url),await this.render_()}async render_(){const t=await this.irl.fetch(),e=i.default.render(s,{taget:this.target_.title,canonical:window.location.href,items:t});this.itemMap_=new Map(t.map(t=>[t.id,t]));const n=new Blob([e],{type:"text/html"}),a=URL.createObjectURL(n),r=this.createIframe_();r.setAttribute("src",a),this.container_.prepend(r),await new Promise(t=>r.addEventListener("load",t)),URL.revokeObjectURL(a),this.iframe_&&this.container_.removeChild(this.iframe_),this.iframe_=r,r.style.display="",this.registerPageChange_(this.onStoryPageChange_)}registerPageChange_(t){const e=this.iframe_.contentDocument.querySelector("amp-story");new MutationObserver(e=>{const i=e.map(t=>t.target).find(t=>"AMP-STORY-PAGE"===t.tagName&&t.hasAttribute("active"));i&&t(i)}).observe(e,{subtree:!0,attributeFilter:["active"]})}createIframe_(){const t=document.createElement("iframe");return t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.style.display="none",t}}exports.default=r;
},{"./RedditService":"Iz2K","./targets":"P52C","mustache":"pLyG","fs":"sC8V"}],"H99C":[function(require,module,exports) {
"use strict";var e=t(require("./StoryManager"));function t(e){return e&&e.__esModule?e:{default:e}}async function n(){new e.default(r()),window.scrollTo(0,1)}function r(){return{container:document.querySelector("#container"),iframe:document.querySelector("#story"),next:document.querySelector("#next"),prev:document.querySelector("#prev"),link:document.querySelector("#link")}}"complete"===document.readyState||"interactive"===document.readyState?n():document.addEventListener("DOMContentLoaded",n);
},{"./StoryManager":"ADAM"}]},{},["H99C"], null)
//# sourceMappingURL=src.0a8559d0.js.map